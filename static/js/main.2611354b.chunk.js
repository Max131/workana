(this.webpackJsonpworkanaChallenge=this.webpackJsonpworkanaChallenge||[]).push([[0],{16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n.n(r),c=n(10),a=n.n(c),i=n(3),o=n.n(i),u=n(4),l=n(2),d=(n(16),n(0)),j=function(){return Object(d.jsx)("div",{className:"loader",children:Object(d.jsxs)("div",{className:"loader__container",children:[Object(d.jsxs)("div",{className:"loader__animation",children:[Object(d.jsx)("div",{className:"loader__cell"}),Object(d.jsx)("div",{className:"loader__cell"}),Object(d.jsx)("div",{className:"loader__cell"}),Object(d.jsx)("div",{className:"loader__cell"})]}),Object(d.jsx)("p",{className:"loader__text",children:"Loading..."})]})})},b=n(5),f=n(9),h=function(e){var t=e.setShowIssueWindow,n=e.setState,s=e.data,c=e.users,a=Object(r.useRef)(null);return Object(d.jsx)("div",{className:"newIssue",children:Object(d.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),!s.data.every((function(e){return e.issue!==+a.current.value})))alert('The issue number "'.concat(a.current.value,'" already exists'));else{c.forEach((function(e){return e.vote=!1}));var r={issue:+a.current.value,validVotes:[1,2,3,5,8,13,20,40,"?"],members:Object(f.a)(c)};n(Object(b.a)(Object(b.a)({},s),{},{data:[].concat(Object(f.a)(s.data),[r])})),function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://todos-9a65.restdb.io/rest/issues",{method:"POST",headers:{"x-api-key":"60f158b149cd3a5cfbd2291f","cache-control":"no-cache","content-type":"application/json"},body:JSON.stringify(r),credentials:"same-origin"}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("_id")?alert("The issue has been added!"):alert("Error: ".concat(e.message))})).catch((function(e){return alert(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),t(!1)}},children:Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("legend",{children:"New Issue"}),Object(d.jsx)("input",{name:"newIssue",id:"newIssue",type:"number",min:"1",defaultValue:"1",className:"input",ref:a}),Object(d.jsx)("button",{className:"loginForm__button addIssue__button",type:"submit",children:"Add"}),Object(d.jsx)("button",{className:"loginForm__button btnIssue",type:"button",onClick:function(){t(!1)},children:"Cancel"})]})})})},O=function(e){var t=e.users,n=e.state,s=e.setState,c=e.setLogin,a=e.setIssue,i=Object(r.useRef)(null),o=Object(r.useRef)(null),u=Object(r.useState)(!1),j=Object(l.a)(u,2),b=j[0],f=j[1],O={};n.data.forEach((function(e){var t=e.members.every((function(e){return!1!==e.vote}));O[e.issue]=t}));var m=function(e){var t=e.value,n=e.text;return Object(d.jsxs)("option",{value:t,children:[n,O[t]&&" (Voted)"]},t)};return Object(d.jsx)("div",{className:"loginPage",children:Object(d.jsxs)("div",{className:"loginPage__container",children:[Object(d.jsx)("p",{className:"title",children:"\u2660\ufe0f Planning Poker"}),Object(d.jsx)("p",{className:"title",children:"Select a user & issue"}),Object(d.jsxs)("form",{className:"loginForm",name:"loginForm",onSubmit:function(e){e.preventDefault();var r=t.filter((function(e){return+e.id===+i.current.value})),s=Object(l.a)(r,1)[0],u=n.data.filter((function(e){return+e.issue===+o.current.value})),d=Object(l.a)(u,1)[0];s&&d&&(c(s),a(d))},children:[Object(d.jsxs)("select",{name:"user",id:"user",className:"loginForm__select",ref:i,children:[Object(d.jsx)("option",{children:"\ud83d\udc64"}),t.map((function(e){return Object(d.jsx)(m,{value:e.id,text:e.name},e.id)}))]}),Object(d.jsxs)("select",{name:"issue",id:"issue",className:"loginForm__select",ref:o,children:[Object(d.jsx)("option",{children:"\ud83d\udd22"}),n.data.map((function(e){return Object(d.jsx)(m,{value:e.issue,text:e.issue},e.issue)}))]}),Object(d.jsx)("button",{className:"loginForm__button",type:"submit",children:"Enter"}),Object(d.jsx)("button",{className:"loginForm__button btnIssue",type:"button",onClick:function(){f(!b)},children:"New Issue"})]}),b&&Object(d.jsx)(h,{setShowIssueWindow:f,setState:s,data:n,users:t})]})})},m=function(e){var t=e.value,n=e.currentVote,r=e.emitVote;return Object(d.jsx)("div",{className:n===t?"card card--active":"card","data-value":t,onClick:function(){return r(t)},children:Object(d.jsx)("p",{children:t})})},p=function(e){var t=e.numUsers,n=e.issue;return Object(d.jsxs)("div",{className:"issue",children:[Object(d.jsx)("p",{children:"Issue:"}),Object(d.jsx)("input",{className:"input",type:"number",value:n,readOnly:!0}),Object(d.jsxs)("p",{children:[t," Connected"]})]})};function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var g=r.createElement("path",{d:"M10.933 13.519L8.707 11.293 7.293 12.707 11.067 16.481 16.769 9.641 15.231 8.359z"}),y=r.createElement("path",{d:"M19,3H5C3.897,3,3,3.897,3,5v14c0,1.103,0.897,2,2,2h14c1.103,0,2-0.897,2-2V5C21,3.897,20.103,3,19,3z M5,19V5h14 l0.002,14H5z"});function w(e,t){var n=e.title,s=e.titleId,c=x(e,["title","titleId"]);return r.createElement("svg",v({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":s},c),n?r.createElement("title",{id:s},n):null,g,y)}var _=r.forwardRef(w);n.p;function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function E(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var S=r.createElement("path",{d:"M7,5C5.897,5,5,5.897,5,7v10c0,1.103,0.897,2,2,2h10c1.103,0,2-0.897,2-2V7c0-1.103-0.897-2-2-2H7z M7,17V7h10l0.002,10H7z"});function I(e,t){var n=e.title,s=e.titleId,c=E(e,["title","titleId"]);return r.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":s},c),n?r.createElement("title",{id:s},n):null,S)}var k=r.forwardRef(I),P=(n.p,function(e){var t=e.user,n=e.current,r=e.allHasVoted,s=t.id===n.id;return Object(d.jsxs)("div",{className:t.vote?"user user--voted":"user",style:s?{order:"-1"}:{},children:[Object(d.jsx)("div",{children:t.vote?Object(d.jsx)(_,{}):Object(d.jsx)(k,{})}),Object(d.jsxs)("div",{children:[t.name," ",s&&"(You)"]}),Object(d.jsx)("div",{children:r||s&&t.vote?t.vote:"-"})]})}),L=function(e){var t=e.error;return Object(d.jsx)("div",{className:"error",children:Object(d.jsxs)("div",{children:[Object(d.jsx)("p",{className:"error__text error__smiley",children:"\ud83d\ude25"}),Object(d.jsx)("p",{className:"error__text",children:t})]})})};function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var F=r.createElement("path",{d:"M19.002 3h-14c-1.103 0-2 .897-2 2v4h2V5h14v14h-14v-4h-2v4c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2V5c0-1.103-.898-2-2-2z"}),H=r.createElement("path",{d:"m11 16 5-4-5-4v3.001H3v2h8z"});function z(e,t){var n=e.title,s=e.titleId,c=C(e,["title","titleId"]);return r.createElement("svg",V({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,ref:t,"aria-labelledby":s},c),n?r.createElement("title",{id:s},n):null,F,H)}var M=r.forwardRef(z),R=(n.p,function(e){var t=e.doLogout;return Object(d.jsx)("button",{className:"logout",onClick:function(){t({id:null,name:null})},title:"Logout",children:Object(d.jsx)(M,{})})}),J=function(e){var t=e.currentIssue,n=e.error,s=e.user,c=e.setLogin,a=Object(r.useState)(Object(b.a)({},t)),i=Object(l.a)(a,2),j=i[0],f=i[1],h=Object(r.useState)(!1),O=Object(l.a)(h,2),v=O[0],x=O[1],g=j.members.findIndex((function(e){return e.id===s.id})),y=j.members[g],w=function(e){y.vote=y.vote!==e&&e,f(Object(b.a)({},j),y)};return Object(r.useEffect)((function(){(function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://todos-9a65.restdb.io/rest/issues/".concat(j._id),{method:"PUT",headers:{"x-api-key":"60f158b149cd3a5cfbd2291f","cache-control":"no-cache","content-type":"application/json"},body:JSON.stringify(j),credentials:"same-origin"}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("_id")?console.info("Updated vote"):alert("Error: ".concat(e.message))})).catch((function(e){return alert(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),x(j.members.every((function(e){return e.vote})))}),[j]),n?Object(d.jsx)(L,{error:n}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(R,{doLogout:c}),Object(d.jsxs)("header",{className:"header",children:[Object(d.jsx)("h1",{className:"header__title",children:"Planning Poker"}),Object(d.jsx)("h2",{className:"header__branding",children:"Workana"}),Object(d.jsx)("p",{className:"header__subtitle",children:"Hiring challenge"})]}),Object(d.jsx)("div",{className:"cards",children:j.validVotes.map((function(e){return Object(d.jsx)(m,{value:e,currentVote:j.members[g].vote,emitVote:w},e)}))}),Object(d.jsx)(p,{numUsers:j.members.length,issue:j.issue}),Object(d.jsx)("div",{className:"users",children:j.members.map((function(e,t){return Object(d.jsx)(P,{user:e,current:y,allHasVoted:v},t)}))})]})},T=function(){var e=Object(r.useState)({isLoading:!0,error:null,data:[]}),t=Object(l.a)(e,2),n=t[0],s=t[1],c=Object(r.useState)([]),a=Object(l.a)(c,2),i=a[0],b=a[1],f=Object(r.useState)({id:null,name:null}),h=Object(l.a)(f,2),m=h[0],p=h[1],v=Object(r.useState)(null),x=Object(l.a)(v,2),g=x[0],y=x[1],w=function(e){var t=e.id,n=e.name;p({id:t,name:n})},_=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://todos-9a65.restdb.io/rest/issues",{headers:{"x-apikey":"60f158b149cd3a5cfbd2291f","Cache-Control":"no-cache","content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){if(e.message)throw e.message;s({data:e,isLoading:!1})})).catch((function(e){return s({isLoading:!1,error:e.message,data:null})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://todos-9a65.restdb.io/rest/pusers",{headers:{"x-apikey":"60f158b149cd3a5cfbd2291f","Cache-Control":"no-cache","content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return b(e)})).catch((function(e){return console.log("Error: ",e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){_(),N(),function(){var e=new EventSource("https://todos-9a65.restdb.io/realtime?apikey=60f158b149cd3a5cfbd2291f");e.addEventListener("put",(function(e){console.log(e.data),_()}),!1),e.addEventListener("post",(function(e){console.log(e.data),_()}),!1),window.addEventListener("beforeunload",(function(){return e.close()}))}()}),[]),n.isLoading?Object(d.jsx)(j,{}):m.id?Object(d.jsx)(J,{currentIssue:g,user:m,error:n.error,setLogin:w}):Object(d.jsx)(O,{users:i,state:n,setState:s,setLogin:w,setIssue:y})};a.a.render(Object(d.jsx)(s.a.StrictMode,{children:Object(d.jsx)(T,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.2611354b.chunk.js.map